<section class="p-8" aria-labelledby="planning-section-title">
  <!-- Header -->
  <header class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8">
    <div>
      <h2 id="planning-section-title" class="text-2xl font-bold text-gray-900">
        {{ 'planning.title' | transloco }}
      </h2>
      <p class="text-gray-500 mt-1">{{ 'planning.subtitle' | transloco }}</p>
    </div>

    <!-- View Controls -->
    <div class="flex gap-2">
      <p-button
        [label]="'planning.month' | transloco"
        [outlined]="view() !== CalendarView.Month"
        severity="secondary"
        size="small"
        (onClick)="setView(CalendarView.Month)"
      />
      <p-button
        [label]="'planning.week' | transloco"
        [outlined]="view() !== CalendarView.Week"
        severity="secondary"
        size="small"
        (onClick)="setView(CalendarView.Week)"
      />
      <p-button
        [label]="'planning.day' | transloco"
        [outlined]="view() !== CalendarView.Day"
        severity="secondary"
        size="small"
        (onClick)="setView(CalendarView.Day)"
      />
    </div>
  </header>

  <!-- Calendar Navigation -->
  <div class="flex justify-between items-center mb-6 bg-white rounded-lg border border-gray-200 p-4">
    <p-button
      icon="pi pi-chevron-left"
      [outlined]="true"
      severity="secondary"
      (onClick)="previousPeriod()"
      [attr.aria-label]="'planning.previous' | transloco"
    />

    <div class="flex items-center gap-4">
      <h3 class="text-lg font-semibold text-gray-900">
        {{ getPeriodLabel() }}
      </h3>
      <p-button
        [label]="'planning.today' | transloco"
        severity="secondary"
        size="small"
        [outlined]="true"
        (onClick)="today()"
      />
    </div>

    <p-button
      icon="pi pi-chevron-right"
      [outlined]="true"
      severity="secondary"
      (onClick)="nextPeriod()"
      [attr.aria-label]="'planning.next' | transloco"
    />
  </div>

  <!-- Calendar -->
  <div class="bg-white rounded-lg border border-gray-200 p-4 shadow-sm">
    @if (loading()) {
      <div class="flex justify-center items-center py-20" role="status" aria-live="polite">
        <i class="pi pi-spin pi-spinner text-4xl text-blue-500" aria-hidden="true"></i>
        <span class="sr-only">{{ 'common.loading' | transloco }}</span>
      </div>
    }

    @if (error()) {
      <div class="text-center py-10" role="alert">
        <p class="text-red-600">{{ error() }}</p>
      </div>
    }

    @if (!loading() && !error()) {
      @switch (view()) {
        @case (CalendarView.Month) {
          <mwl-calendar-month-view
            [viewDate]="viewDate()"
            [events]="events()"
            [locale]="locale()"
            (eventClicked)="onEventClick($event.event)"
          />
        }
        @case (CalendarView.Week) {
          <mwl-calendar-week-view
            [viewDate]="viewDate()"
            [events]="events()"
            [locale]="locale()"
            (eventClicked)="onEventClick($event.event)"
          />
        }
        @case (CalendarView.Day) {
          <mwl-calendar-day-view
            [viewDate]="viewDate()"
            [events]="events()"
            [locale]="locale()"
            (eventClicked)="onEventClick($event.event)"
          />
        }
      }
    }
  </div>
</section>
