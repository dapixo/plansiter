<section class="p-8 bg-gray-50 min-h-full" aria-labelledby="planning-section-title">
  <!-- Header -->
  <header class="mb-8">
    <h1 id="planning-section-title" class="text-4xl font-bold mb-2">
      <span class="bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">
        {{ 'planning.title' | transloco }}
      </span>
    </h1>
    <p class="text-gray-600 text-lg">{{ 'planning.subtitle' | transloco }}</p>
  </header>

  <!-- Calendar Navigation -->
  <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-6">
    <!-- Period Label -->
    <div class="text-lg text-gray-700">
      {{ periodLabel() }}
    </div>

    <!-- Navigation Controls -->
    <div class="flex items-stretch gap-3">
      <!-- Previous/Today/Next Navigation -->
      <div class="inline-flex items-stretch bg-white rounded-lg border border-gray-200 shadow-sm h-11">
        <button
          type="button"
          (click)="previousPeriod()"
          class="px-3 text-gray-600 hover:text-gray-900 hover:bg-gray-50 transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-inset rounded-l-lg flex items-center"
          [attr.aria-label]="'planning.previous' | transloco"
        >
          <i class="pi pi-chevron-left text-sm" aria-hidden="true"></i>
        </button>
        <button
          type="button"
          (click)="today()"
          class="px-6 text-sm font-medium text-gray-700 hover:text-gray-900 border-x border-gray-200 hover:bg-gray-50 transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-inset flex items-center"
        >
          {{ 'planning.today' | transloco }}
        </button>
        <button
          type="button"
          (click)="nextPeriod()"
          class="px-3 text-gray-600 hover:text-gray-900 hover:bg-gray-50 transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-inset rounded-r-lg flex items-center"
          [attr.aria-label]="'planning.next' | transloco"
        >
          <i class="pi pi-chevron-right text-sm" aria-hidden="true"></i>
        </button>
      </div>

      <!-- View Selector -->
      <p-select
        [options]="viewOptions"
        [ngModel]="view()"
        (ngModelChange)="setView($event)"
        optionValue="value"
        [style]="{ height: '44px' }"
        class="w-40"
        [placeholder]="'planning.month' | transloco"
      >
        <ng-template pTemplate="selectedItem" let-selectedOption>
          @if (selectedOption) {
            {{ selectedOption.labelKey | transloco }}
          }
        </ng-template>
        <ng-template pTemplate="item" let-option>
          {{ option.labelKey | transloco }}
        </ng-template>
      </p-select>

      <!-- Add Booking Button -->
      <button
        type="button"
        (click)="openBookingDialog()"
        class="h-11 px-6 text-sm font-semibold text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 rounded-lg shadow-md hover:shadow-lg transition-all focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center"
      >
        <i class="pi pi-plus mr-2" aria-hidden="true"></i>
        {{ 'planning.addBooking' | transloco }}
      </button>
    </div>
  </div>

  <!-- Calendar -->
  <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
    @if (loading()) {
      <div class="flex justify-center items-center py-20" role="status" aria-live="polite">
        <i class="pi pi-spin pi-spinner text-4xl text-indigo-600" aria-hidden="true"></i>
        <span class="sr-only">{{ 'common.loading' | transloco }}</span>
      </div>
    }

    @if (error()) {
      <div class="text-center py-10" role="alert">
        <p class="text-red-600">{{ error() }}</p>
      </div>
    }

    @if (!loading() && !error()) {
      @switch (view()) {
        @case (CalendarView.Month) {
          <mwl-calendar-month-view
            [viewDate]="viewDate()"
            [events]="events()"
            [locale]="locale()"
            (eventClicked)="onEventClick($event.event)"
          />
        }
        @case (CalendarView.Week) {
          <mwl-calendar-week-view
            [viewDate]="viewDate()"
            [events]="events()"
            [locale]="locale()"
            (eventClicked)="onEventClick($event.event)"
          />
        }
        @case (CalendarView.Day) {
          <mwl-calendar-day-view
            [viewDate]="viewDate()"
            [events]="events()"
            [locale]="locale()"
            (eventClicked)="onEventClick($event.event)"
          />
        }
      }
    }
  </div>

  <!-- Booking Form Dialog -->
  <app-booking-form-dialog
    [(bookingDialogVisible)]="bookingDialogVisible"
    (bookingCreated)="onBookingCreated($event)"
  />
</section>
